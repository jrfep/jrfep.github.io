---
title: "Una breve caracterización ambiental del Parque Nacional Guatopo en Venezuela"
author: "José R. Ferrer Paris (@jrfep)"
date: "Marzo 31, 2022"
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE)
```

El Parque Nacional "Guatopo" fue creado el 31 de Marzo de 1958 y está ubicado entre los estados Miranda, Aragua, Guárico. A pesar de la importancia de las zonas protegidas para la política de conservación de nuestro país, muchas de estas áreas no han sido evaluadas y caracterizadas detalladamente, y gran parte de las investigaciones se mantienen sin publicar o publicadas en informes de difusión restringida.

Durante un tiempo la página web de la antigua *Unidad de Sistemas de Información Geográfica del Centro de Ecología* ([ecoSIG](http://www.ecosig.org.ve)) del **Instituto Venezolano de Investigaciones Científicas** ([IVIC](http://www.ivic.gob.ve/)) fue un punto de referencia de información sobre los parques nacionales y otras áreas protegidas de Venezuela. Lamentablemente no existe en este momento una persona encargada de darle continuidad y mantenimiento a este recurso.

Desde el [*Laboratorio de Ecología Espacial*](http://www.ivic.gob.ve/es/investigacion-3/centros-31/estudios-botanicos-y-agroforestales-ceba-zulia/laboratorios/ecologi-a-espacial/personal) del IVIC realizamos algunos trabajos enfocados en la caracterización ambiental de diferentes regiones del país. Algunos de esos trabajos están publicados en formato de reportes electrónicos en un perfil público en [fig**share**](https://figshare.com/search?q=NeoMapas&searchMode=1). A través de esta página quisiera continuar difundiendo al menos parte de los resultados que durante años hemos tratado de promover desde el laboratorio, y que no hemos podido concluir por la falta de presupuesto del área de investigación del instituto.

Para el día de hoy aprovecho el 64 aniversario de la creación del parque "Guatopo" para mostrar algunos detalles de la caracterización ambiental del parque basada en la evaluación de datos de sensores remotos.

## Análisis en R

Para este análisis necesito varias funciones de los siguientes paquetes de R:

```{r}
library(dplyr)
library(mapview)
library(terra)
library(wdpar)
library(elevatr)
```


## Datos utilizados

Los datos geográficos de los linderos del parque fueron obtenidos de tres fuentes electrónicas de libre acceso utilizando paquetes de R para la descarga de los datos.

Los linderos del parque los descargamos de la base de datos de áreas protegidas del mundo [WDPA](https://www.protectedplanet.net/325) usando el paquete `wdpar`. La función `wdpa_fetch` descarga los datos de los parques de Venezuela (indicado con el valor de "VEN"), y la función `wdpa_clean` realiza varios pasos de limpieza y verificación de los datos. Luego uso las funciones `filter` y `select` del paquete `dplyr` para filtrar los datos.

```{r}
library(wdpar)
cod_raw_pa_data <- wdpa_fetch("VEN") %>% filter(WDPAID == 325)
cod_pa_data <- wdpa_clean(cod_raw_pa_data)
Guatopo <- cod_pa_data  %>% select(DESIG,ORIG_NAME,IUCN_CAT,REP_AREA,STATUS_YR,MANG_AUTH)
```

Para los datos de elevación utilizo el paquete [`elevatr`](https://cran.r-project.org/web/packages/elevatr/vignettes/introduction_to_elevatr.html) que utiliza una variedad de API para el acceso programático a datos de diversas fuentes. La función `get_elev_raster` descarga datos de [Terrain Tiles en Amazon Web Services](https://registry.opendata.aws/terrain-tiles/) que provienen de la compilación del difunto servicio Mapzen, que a su vez compila datos de varios productos globales y regionales de modelos de elevación digital. El valor de `z` indica el nivel de resolución deseado, según la documentación de [Mapzen](https://github.com/tilezen/joerd/blob/master/docs/data-sources.md#what-is-the-ground-resolution).

```{r}
library(elevatr)
Guatopo.SRTM <- get_elev_raster(Guatopo, z = 9)
```

Para los datos de precipitación utilizo la base de datos *CHIRPS* [versión 2.0](http://chg.geog.ucsb.edu/data/chirps/) que combina información de sensores remotos y estaciones climáticas (Funk et al. 2015). El paquete


```{r}
library(chirps)

# selecciones tres puntos dentro del lindero del parque
set.seed(1234)
Guatopo_sample <- st_sample(Guatopo %>% st_transform("EPSG:4326"), 3) %>% 
  st_as_sf()

library(doParallel)
library(foreach)

cl <- makeCluster(8)
registerDoParallel(cl)

Guatopo.CHIRPS <- foreach(yy = 1982:1990, 
                          .combine='rbind',
                          .packages = 'chirps') %dopar% {
  qry_dates <- sprintf(c("%s-01-01","%s-12-31"), yy) 
  dat <- get_chirps(Guatopo_sample,
                  qry_dates, 
                  server = "ClimateSERV")
  return(dat)
                          }
nrow(Guatopo.CHIRPS)
stopCluster(cl)




#Guatopo.vect <- vect(Guatopo %>% st_transform("EPSG:4326"))
#Guatopo.CHIRPS <- get_chirps(Guatopo.vect, dates, server = "CHC", as.raster = TRUE)
```




## Ubicación relativa del PN Guatopo

El [Parque Nacional Guatopo](https://es.wikipedia.org/wiki/Parque_nacional_Guatopo) se encuentra entre los estados Miranda, Aragua y Guárico.

```{r Ubicacion,fig.width=7,fig.height=6}
mapview(Guatopo)
```

## Elevación y precipitación según sensores remotos

Visualizamos la topografía del parque usando los datos de elevación derivados de SRTM. Se aprecia en la porción sur del parque la Fila Maestra de la Serranía del Interior en [donde nacen varios ríos](http://guatopoenlahistoria.blogspot.com/2011/08/proyecto-embalse-del-rio-macaira.html) que drenan hacia la cuenca del río Tuy en el norte y hacia los llanos de Guárico en el sur.  

```{r Elevación,fig.width=8,fig.height=5.5}
plot(Guatopo.SRTM)
contour(Guatopo.SRTM,add=T)
plot(st_geometry(Guatopo), add = TRUE, border = "maroon", lwd=3, alpha=.6)
```

Precisamente el decreto de creación del parque busca proteger las cabeceras de estos ríos por la importancia que tienen para las zonas densamente pobladas del estado Miranda y las zonas productivas en la vertiente llanera. 

A partir de las mediciones de la base de datos Chirps construimos una serie de tiempo de la precipitación mensual estimada desde 1981 hasta 2018. En la parte inferior del gráfico se observa la variabilidad de los valores mensuales, y en los gráficos intermedio y superior se observan los valores agregados para periodos semestrales y anuales, que permiten observar efectos acumulados de los cambios de la precipitación.

```{r Precipitación,fig.width=8,fig.height=5}
dias <- (cumsum(c(31,28,31,30,31,30,31,31,30,31,30,31))-15)/365

lubridate::yday(dat$date)

y <- t(values(PN.chirps))
x <- as.numeric(substr(names(PN.chirps),13,16))+
  dias[as.numeric(substr(names(PN.chirps),18,21))]

layout(matrix(c(3,2,1,1),ncol=1))
par(mar=c(5,5,1,0),oma=c(0,2,0,0))
matplot(x,y,type="l",col=rgb(.5,.5,.5,.15),ylab="",axes=F,xlab="")
axis(2)
mtext("mensual",2,line=3)
yy <- 1981:2018
lines(x,apply(y,1,median))
axis(1,yy[yy %% 10 >0],cex.axis=.7,line=0,col="slateblue",las=2,lwd=3,lwd.ticks=1)
axis(1,yy[yy %% 10 %in% 0],cex.axis=1.15,line=0,col="slateblue",las=2,lwd.ticks=3,lwd=0)

par(mar=c(0,5,0,0))
matplot(x,filter(y, rep(1, 6),sides=1),col=rgb(.1,.1,.8,.15),lwd=2,type="l",axes=F,ylab="")
axis(2,line=-1)
mtext("semestral",2,line=2)

plot(x,filter(apply(y,1,median), rep(1, 12),sides=1),type="l",col="slateblue4",lwd=4,axes=F,ylab="")
axis(2,line=-2)
mtext("anual",2,line=1)

mtext("Precipitación [mm]",2,outer=T)


```

Entre 1980 y 2000 la serie de tiempo muestra un patrón más o menos regular aunque con valores extremos cada vez más frecuentes y de mayor magnitud. Sin embargo los años recientes muestran una tendencia negativa preocupante. En el gráfico de precipitación acumulada semestral es bastante evidente el efecto de la prolongada sequía de 2009 seguida de fuertes lluvias en 2010. En el gráfico superior se evidencia además que después del pico de este año se ha acentuado una tendencia negativa de varios años con una reciente recuperación. Es necesario monitorear estos valores en el futuro para determinar si se recuperaran las fluctuaciones regulares de las décadas anteriores. 

## Continuará...

Este es un breve ejemplo de los datos que se pueden extraer de sensores remotos para el monitoreo ambiental del Parque Nacional "Guatopo" que pueden ser de utilidad para trabajos ecológicos futuros en esta importante área protegida del país.

Les agradezco sus comentarios y sugerencias a traves de las cuentas de twitter @[jrfep](http://twitter.com/jrfep) y @[NeoMapas](http://twitter.com/NeoMapas).


### Referencias

Funk et al. (2015) [*The climate hazards infrared precipitation with stations—a new environmental record for monitoring extremes*](https://doi.org/10.1038/sdata.2015.66). **Scientific Data** 2: 150066.

